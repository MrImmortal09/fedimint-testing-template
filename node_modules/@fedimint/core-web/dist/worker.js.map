{"version":3,"file":"worker.js","sources":["../src/worker/worker.js"],"sourcesContent":["// Web Worker for fedimint-client-wasm to run in the browser\n\n// HACK: Fixes vitest browser runner\n// TODO: remove once https://github.com/vitest-dev/vitest/pull/6569 lands in a release\nglobalThis.__vitest_browser_runner__ = { wrapDynamicImport: (foo) => foo() }\n\nlet rpcHandler = null\n\nconsole.log('Worker - init')\n\nself.onmessage = async (event) => {\n  if (event.type === 'init') {\n    try {\n      const { RpcHandler } = await import(\n        '@fedimint/fedimint-client-wasm-bundler'\n      )\n      rpcHandler = new RpcHandler()\n      self.postMessage({ type: 'init_success' })\n    } catch (err) {\n      console.error('Worker init failed:', err)\n      self.postMessage({ type: 'init_error', error: err.toString() })\n    }\n  } else {\n    rpcHandler.rpc(JSON.stringify(event.data), (response) =>\n      self.postMessage(JSON.parse(response)),\n    )\n  }\n}"],"names":["globalThis","__vitest_browser_runner__","wrapDynamicImport","foo","rpcHandler","console","log","self","onmessage","async","event","type","RpcHandler","import","postMessage","err","error","toString","rpc","JSON","stringify","data","response","parse"],"mappings":"AAIAA,WAAWC,0BAA4B,CAAEC,kBAAoBC,GAAQA,KAErE,IAAIC,EAAa,KAEjBC,QAAQC,IAAI,iBAEZC,KAAKC,UAAYC,MAAOC,IACtB,GAAmB,SAAfA,EAAMC,KACR,IACE,MAAMC,WAAEA,SAAqBC,OAC3B,0CAEFT,EAAa,IAAIQ,EACjBL,KAAKO,YAAY,CAAEH,KAAM,gBAC1B,CAAC,MAAOI,GACPV,QAAQW,MAAM,sBAAuBD,GACrCR,KAAKO,YAAY,CAAEH,KAAM,aAAcK,MAAOD,EAAIE,YACxD,MAEIb,EAAWc,IAAIC,KAAKC,UAAUV,EAAMW,OAAQC,GAC1Cf,KAAKO,YAAYK,KAAKI,MAAMD,KAElC"}